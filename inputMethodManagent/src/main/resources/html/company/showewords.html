<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>员工话术</title>
</head>
<body style="background-color:#EFF0F4;">
<div>
    <img src="img.png" ;width="50px" ; height="50px" ; style="position:absolute; left:150px; top:25px; ">
</div>

<!..顶部白色色块..>
<div style="background-color: rgba(253, 253, 253, 100); width:1100px; height:50px;position:absolute; left:303px; top:25px;">
    <img src="img_1.png" ;width="30px" ; height="30px" ; style="position:absolute; left:1060px; top:10px; ">
    <p style="width: 100px;height: 20px;color: rgba(56, 58, 64, 100);font-size: 15px;position:absolute; left:5px; top:0px; ">首页 / 员工 / </p>
    <p id="ename" style="width: 300px;height: 20px;color: gray;font-size: 15px;position:absolute; left:97px; top:0px; ">话术列表</p>

    <!..退出登录超链接..>
    <a href="Login.html"
       style="text-decoration: none;width:60px;height: 50px;line-height: 20px;color: blue;font-size: 15px;position:absolute; left:995px;top:15px;" >退出登录</a>
    <a href="yuangong1.html"
       style="text-decoration: none;width:60px;height: 50px;line-height: 20px;color: blue;font-size: 15px;position:absolute; left:950px;top:15px;" >返回</a>

</div>

<!..搜索..>
<div style="background-color:white; width:1252px; height:55px;position:absolute; left:151px; top:82px;">
    <img src="img_2.jpg" ;width="32px" ; height="32px" ; style="position:absolute; left:5px; top:0px; ">
    <!..文字..>
    <p  style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:165px; top:0px; ">输入搜索:</p>
    <p  style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:620px; top:0px; ">添加日期:</p>

    <!..输入框..>
    <input type="text" placeholder="输入话术关键字" id="text1" style="position:absolute; left:240px; top:10px;width: 200px;height: 30px;color: rgba(136, 136, 136, 100);font-size: 14px;text-align: left;font-family:微软雅黑"/>
    <input type="date"  id="text3" style="position:absolute; left:700px; top:10px;width: 200px;height: 30px;color: rgba(136, 136, 136, 100);font-size: 14px;text-align: left;font-family:微软雅黑"/>

    <!..按钮..>
    <button   style="width: 60px;height: 30px;border-radius: 4px;color: black;background-color:white;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);position:absolute; left:1068px; top:10px;" onclick="reset()">重置</button>
    <button   style="width: 100px;height: 30px;border-radius: 4px;color: white;background-color:#3C6AEC ;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);position:absolute; left:1140px; top:10px;" onclick="found()" >查询结果</button>

</div>

<!..中间白色色块..>
<div style="background-color:white; width:1252px; height:60px;position:absolute; left:150px; top:144px;">
    <img src="img_5.png" ;width="25px" ; height="25px" ; style="position:absolute; left:0px; top:18px; ">
    <button   style="width: 130px;height: 30px;border-radius: 4px;color: black;background-color:white;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);position:absolute; left:1110px; top:15px;" onclick="toother()">添加员工话术</button>

</div>



<table id="table1" style="position:absolute; left:150px; top:210px;">
    <tr style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">编号</td>
        <td style="width:887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">内容</td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">添加日期</td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">操作</td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="1" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd1()">删除</button>
        </td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height:54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="2" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd2()">删除</button>
        </td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="3" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd3()">删除</button>
        </td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="4" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd4()">删除</button>
        </td>

    </tr>
    <tr  style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="5" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd5()">删除</button>
        </td>

    </tr>
    <tr  style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="6" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd6()">删除</button>
        </td>

    </tr>
    <tr  style="background-color: white">
        <td style="width: 82px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 887px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: left;"></td>
        <td style="width: 147px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;"></td>
        <td style="width: 122px;height: 54px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(136, 136, 136, 100);font-size: 18px;text-align: center;">
            <button id="7" style="margin-top:10px;width: 70px;height: 30px;border-radius: 4px;border: 1px solid rgba(187, 187, 187, 100);background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;" onclick="dd7()">删除</button>
        </td>

    </tr>
</table>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1215px; top:675px;" onclick="up()">上一页</button>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1345px; top:675px;" onclick="down()">下一页</button>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1150px; top:675px;" onclick="reshow()">刷新</button>
<p id="page2" style="width: 60px;height: 30px;border:none;font-size: 15px;text-align: center;position:absolute; left:1280px; top:665px;"></p>
<p id="page1" style="width: 60px;height: 30px;border:none;font-size: 15px;text-align: center;position:absolute; left:1085px; top:665px;"></p>


<!..添加页面..>
<div id="addehuashu" style="display: none">
    <div style="opacity:0.6;background-color: rgba(239, 240, 244, 100);color: rgba(16, 16, 16, 100);width:1160px; height:700px;position:absolute; left:160px; top:80px;">
    </div>

    <div style="height:280px;width:600px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 100);font-size: 14px;position:absolute; left:550px; top:220px;">
        <p style="color: rgba(16, 16, 16, 100);font-size: 18px;margin-left:250px;margin-top:5px; ">添加话术</p>
        <textarea  placeholder="请输入话术内容" id="newtext" style="margin-left:70px;margin-top:10px;width: 450px;height: 130px;color: black;font-size: 18px;text-align: left;"></textarea>
        <button   style="margin-left:210px;margin-top:20px;width: 60px;height: 30px;border-radius: 4px;color: white;background-color:#3C6AEC ;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);" onclick="addghs()" >添加</button>
        <button   style="margin-left:50px;margin-top:20px;width: 60px;height: 30px;border-radius: 4px;color: black;background-color:white;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);" onclick="addclose()">取消</button>
    </div>
</div>


</body>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.12.3.min.js"></script>
<script type="text/javascript"></script>
<script>
    var epnum=7;
    clear();
   var em_email=getCookie("employ_email");
   var em_name=getCookie("employ_name");
   document.getElementById("ename").innerHTML=em_name+"的话术列表";
   function getCookie(cookie_name) {
       var allcookies = document.cookie;

       var cookie_pos = allcookies.indexOf(cookie_name);

       if (cookie_pos !== -1) {
           cookie_pos = cookie_pos + cookie_name.length + 1;
           var cookie_end = allcookies.indexOf(";", cookie_pos);
           if (cookie_end === -1) {
               cookie_end = allcookies.length;
           }
           var value = unescape(allcookies.substring(cookie_pos, cookie_end));
       }
       return value;
   }
   function toother(){
       document.getElementById("addehuashu").style.display="block";
   }

   var data2;

   var data={"u_email":em_email};
   var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
   httpRequest.open("POST", "http://localhost:8088/userwords/showUserWords",true);  //调用AddDataToServer
   httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
   httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
  // 回调函数，获取返回数据
   httpRequest.onreadystatechange = function() {
       if (httpRequest.readyState == 4) {
           //根据服务器的响应内容格式处理响应结果
           if(httpRequest.getResponseHeader('content-type')==='application/json'){
               var result = JSON.parse(httpRequest.responseText);
               if(result[0]["w_content"]){
                   data2=result;
                   index=1;
                   showin();
               }
           }
       }
   }
   var index=1;
   function showin(){
       document.getElementById("page1").innerHTML="共"+data2.length+"条";
       var manylen=parseInt(data2.length/epnum);
       if( data2.length%epnum >0){
           manylen=manylen+1;
       }
       document.getElementById("page2").innerHTML=index+"/"+manylen;
       var tr = $("#table1 tr");//获取table中的tr
       if(data2.length>=index*epnum){
           for(var i=1;i<=epnum;i++){
               var td = $(tr[i]).find("td");
               $(td[0]).html((index-1)*epnum+i);
               $(td[1]).html(data2[(index-1)*epnum+i-1]["w_content"]);
               $(td[2]).html(data2[(index-1)*epnum+i-1]["w_createDate"]);
               document.getElementById(i).style.display="block";
               document.getElementById(i).style="width: 70px;height: 35px;border: 1px solid rgba(187, 187, 187, 100);border-radius: 4px;background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;";
           }
       }
       else{
           for(var i=1;i<=data2.length%epnum;i++){
               var td = $(tr[i]).find("td");
               $(td[0]).html((index-1)*epnum+i);
               $(td[1]).html(data2[(index-1)*epnum+i-1]["w_content"]);
               $(td[2]).html(data2[(index-1)*epnum+i-1]["w_createDate"]);
               document.getElementById(i).style.display="block";
               document.getElementById(i).style="width: 70px;height: 35px;border: 1px solid rgba(187, 187, 187, 100);border-radius: 4px;background-color: rgba(240, 76, 76, 100);color: rgba(255, 255, 255, 100);font-size: 16px;text-align: center;";

           }
       }

   }
   function addclose() {
       document.getElementById("newtext").value="";
       document.getElementById("addehuashu").style.display="none";
   }
   function addghs() {
       var ctext=document.getElementById("newtext").value;
       var myDate = new Date();
       var y=myDate.getFullYear();
       var m=myDate.getMonth()+1;
       var d=myDate.getDate();
       var t=y+"-"+m+"-"+d;
       var data={"u_email":em_email,"w_content":ctext,"w_createDate":t};
       var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
       httpRequest.open("POST", "http://localhost:8088/userwords/addUserWords",true);  //调用AddDataToServer
       httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
       httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
       //回调函数，获取返回数据
       httpRequest.onreadystatechange = function() {
           if (httpRequest.readyState == 4) {
               //根据服务器的响应内容格式处理响应结果
               if(httpRequest.getResponseHeader('content-type')==='application/json'){
                   var result = JSON.parse(httpRequest.responseText);
                   if(result["code"]== 7000){
                       alert("添加成功");
                       document.getElementById("newtext").value="";
                       document.getElementById("addehuashu").style.display="none";
                       getnew();
                   }
                   else{
                       alert("添加失败");
                   }
               }
           }
       }

   }
   function  getnew() {
       var data={"u_email":em_email};
       var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
       httpRequest.open("POST", "http://localhost:8088/userwords/showUserWords",true);  //调用AddDataToServer
       httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
       httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
       // 回调函数，获取返回数据
       httpRequest.onreadystatechange = function() {
           if (httpRequest.readyState == 4) {
               //根据服务器的响应内容格式处理响应结果
               if(httpRequest.getResponseHeader('content-type')==='application/json'){
                   var result = JSON.parse(httpRequest.responseText);
                   if(result[0]){
                       data2=result;
                       index=1;
                       showin();
                   }
               }
           }
       }
   }
    function clear(){
        var tr = $("#table1 tr");
        for(var i=1;i<=epnum;i++){
            var td = $(tr[i]).find("td");
            $(td[0]).html("");
            $(td[1]).html("");
            $(td[2]).html("");
            document.getElementById(i).style.display="none";

        }
    }
    function down(){
        if(index*epnum<data2.length){
            index=index+1;
            clear();
            showin();
        }
    }
    function up(){
        if(index>1){
            index=index-1;
            clear();
            showin();
        }
    }
    function dd1(){
        var tr = $("#table1 tr");
        var td = $(tr[1]).find("td");
        gotod($(td[1]).eq(0).text());

    }
    function dd2(){
        var tr = $("#table1 tr");
        var td = $(tr[2]).find("td");gotod($(td[1]).eq(0).text());
    }
    function dd3(){
        var tr = $("#table1 tr");
        var td = $(tr[3]).find("td");gotod($(td[1]).eq(0).text());
    }
    function dd4(){
        var tr = $("#table1 tr");
        var td = $(tr[4]).find("td");gotod($(td[1]).eq(0).text());
    }
    function dd5(){
        var tr = $("#table1 tr");
        var td = $(tr[5]).find("td");gotod($(td[1]).eq(0).text());
    }
    function dd5(){
        var tr = $("#table1 tr");
        var td = $(tr[6]).find("td");gotod($(td[1]).eq(0).text());
    }
    function dd5(){
        var tr = $("#table1 tr");
        var td = $(tr[7]).find("td");gotod($(td[1]).eq(0).text());
    }
    function gotod(a){
        var data={"u_email":em_email,"w_content":a};
        var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
        httpRequest.open("POST", "http://localhost:8088/userwords/deleteUserWords",true);  //调用AddDataToServer
        httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
        httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
        //回调函数，获取返回数据
        httpRequest.onreadystatechange = function() {
            if (httpRequest.readyState == 4) {
                //根据服务器的响应内容格式处理响应结果
                if(httpRequest.getResponseHeader('content-type')==='application/json'){
                    var result = JSON.parse(httpRequest.responseText);
                    if(result["code"]===8000) {
                        clear();
                        getnew();
                        alert("删除成功");
                    }
                }
            }
        }
    }
    function chang(a){
        if(a===""){
            return null;
        }
        else{
            return a;
        }
    }
    function reset() {
       document.getElementById("text1").value="";
        document.getElementById("text3").value="";
    }
   function found(){
       var atext=chang(document.getElementById("text1").value);
       var adate=chang(document.getElementById("text3").value);
       var data={"u_email":em_email,"w_content":atext,"w_createDate":adate};
       var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
       httpRequest.open("POST", "http://localhost:8088/userwords/searchUserWords",true);  //调用AddDataToServer
       httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
       httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
       //回调函数，获取返回数据
       httpRequest.onreadystatechange = function() {
           if (httpRequest.readyState == 4) {
               //根据服务器的响应内容格式处理响应结果
               if(httpRequest.getResponseHeader('content-type')==='application/json'){
                   var result = JSON.parse(httpRequest.responseText);
                   if(result[0]) {
                       data2=result;
                       clear();
                       showin();
                   }
                   else{
                       alert("没有相关数据");
                   }
               }
           }
       }
   }

</script>
</html>