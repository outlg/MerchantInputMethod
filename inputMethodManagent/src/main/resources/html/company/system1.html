<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>公司</title>
</head>
<body style="background-color:#EFF0F4;">
<div>
    <img src="img.png" ;width="50px" ; height="50px" ; style="position:absolute; left:60px; top:43px; ">
</div>

<!..顶部白色色块..>
<div style="background-color: rgba(253, 253, 253, 100); width:1260px; height:50px;position:absolute; left:213px; top:43px;">
    <img src="img_1.png" ;width="30px" ; height="30px" ; style="position:absolute; left:1220px; top:10px; ">
    <p style="width: 100px;height: 20px;color: rgba(56, 58, 64, 100);font-size: 15px;position:absolute; left:50px; top:0px; ">首页 / 公司 / </p>
    <p style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:141px; top:0px; ">公司列表</p>

    <!..退出登录超链接..>
    <a href="Login.html"
       style="text-decoration: none;width:60px;height: 50px;line-height: 20px;color: blue;font-size: 15px;position:absolute; left:1155px;top:15px;" >退出登录</a>
</div>

<!..搜索..>
<div style="background-color:white; width:1252px; height:150px;position:absolute; left:220px; top:100px;">
    <img src="img_2.png" ;width="32px" ; height="32px" ; style="position:absolute; left:10px; top:10px; ">
    <!..文字..>
    <p  style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:105px; top:55px; ">公司名称:</p>
    <p  style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:480px; top:55px; ">公司类别:</p>
    <p  style="width: 100px;height: 20px;color: gray;font-size: 15px;position:absolute; left:855px; top:55px; ">公司地址:</p>
    <!..输入框..>
    <input type="text" placeholder="输入公司名称关键字" id="text1" style="position:absolute; left:180px; top:65px;width: 200px;height: 30px;color: rgba(136, 136, 136, 100);font-size: 14px;text-align: left;"/>
    <input type="text" placeholder="输入公司类别关键字" id="text2" style="position:absolute; left:555px; top:65px;width: 200px;height: 30px;color: rgba(136, 136, 136, 100);font-size: 14px;text-align: left;"/>
    <input type="text" placeholder="输入公司地址关键字" id="text3" style="position:absolute; left:930px; top:65px;width: 200px;height: 30px;color: rgba(136, 136, 136, 100);font-size: 14px;text-align: left;"/>
    <!..按钮..>
    <button   style="width: 60px;height: 30px;border-radius: 4px;color: black;background-color:white;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);position:absolute; left:1068px; top:10px;" onclick="reset()">重置</button>
    <button   style="width: 100px;height: 30px;border-radius: 4px;color: white;background-color:#3C6AEC ;font-size: 15px;border: 1px solid rgba(187, 187, 187, 100);position:absolute; left:1140px; top:10px;" onclick="found()" >查询结果</button>

</div>



<table id="table1" style="position:absolute; left:220px; top:257px;">
    <tr style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">编号</td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">公司名称</td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">公司类别</td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">公司邮箱</td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;">公司地址</td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>

    </tr>
    <tr style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
    </tr>
    <tr style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
    </tr>
    <tr style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
    </tr>
    <tr  style="background-color: white">
        <td style="width: 100px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
        <td style="width: 189px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 300px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: center;"></td>
        <td style="width: 322px;height: 60px;line-height: 20px;background-color: rgba(255, 255, 255, 100);color: rgba(16, 16, 16, 56);font-size: 18px;text-align: left;"></td>
    </tr>
</table>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1290px; top:645px;" onclick="up()">上一页</button>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1412px; top:645px;" onclick="down()">下一页</button>
<button style="width: 60px;height: 30px;border-radius: 1px;background-color: rgba(255, 255, 255, 100);font-size: 15px;text-align: center;border: 1px solid rgba(232, 232, 232, 100);position:absolute; left:1220px; top:645px;" onclick="reshow()">刷新</button>
<p id="page2" style="width: 60px;height: 30px;border:none;font-size: 15px;text-align: center;position:absolute; left:1350px; top:635px;"></p>
<p id="page1" style="width: 60px;height: 30px;border:none;font-size: 15px;text-align: center;position:absolute; left:1155px; top:635px;"></p>


<!..左边黑色色块..>
<div style="background-color:#2D3A4B; width:153px; height:630px;position:absolute; left:60px; top:93px;">
    <summary style="color:white;left:10px; top:10px;padding-left:55px;padding-top:25px;" ><a id="l1" style="font-size: 15px;color: white;text-decoration: none;" href="#">公司</a></summary>
    <summary style="color:white;left:10px; top:10px;padding-left:40px;padding-top:25px;" ><a style="font-size: 15px;color: white;text-decoration: none;" href="person.html">个人中心</a></summary>
</div>




</body>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.12.3.min.js"></script>
<script type="text/javascript"></script>
<script>
    document.getElementById("l1").style.color="#409EFF";
    var em_email=getCookie("user_email");
   // var em_email="123456"
    function getCookie(cookie_name) {
        var allcookies = document.cookie;

        var cookie_pos = allcookies.indexOf(cookie_name);

        if (cookie_pos !== -1) {
            cookie_pos = cookie_pos + cookie_name.length + 1;
            var cookie_end = allcookies.indexOf(";", cookie_pos);
            if (cookie_end === -1) {
                cookie_end = allcookies.length;
            }
            var value = unescape(allcookies.substring(cookie_pos, cookie_end));
        }
        return value;
    }

    var data2;

    var data={"u_email":em_email};
    var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
    httpRequest.open("POST", "http://localhost:8088/company/showCompany",true);  //调用AddDataToServer
    httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
    httpRequest.send(JSON.stringify(data)); //设置为发送给服务器数据
    // 回调函数，获取返回数据
    httpRequest.onreadystatechange = function() {
        if (httpRequest.readyState == 4) {
            //根据服务器的响应内容格式处理响应结果
            if(httpRequest.getResponseHeader('content-type')==='application/json'){
                var result = JSON.parse(httpRequest.responseText);
                if(result[0]){
                    data2=result;
                    index=1;
                    showin();
                }
            }
        }
    }
    var index=1;
    function showin(){
        document.getElementById("page1").innerHTML="共"+data2.length+"条";
        var manylen=parseInt(data2.length/5);
        if( data2.length%5 >0){
            manylen=manylen+1;
        }
        document.getElementById("page2").innerHTML=index+"/"+manylen;
        var tr = $("#table1 tr");//获取table中的tr
        if(data2.length>=index*5){
            for(var i=1;i<=5;i++){
                var td = $(tr[i]).find("td");
                $(td[0]).html((index-1)*5+i);
                $(td[1]).html(data2[(index-1)*5+i-1]["c_name"]);
                $(td[2]).html(data2[(index-1)*5+i-1]["c_type"]);
                $(td[3]).html(data2[(index-1)*5+i-1]["c_connect"]);
                $(td[4]).html(data2[(index-1)*5+i-1]["c_address"]);
            }
        }
        else{
            for(var i=1;i<=data2.length%5;i++){
                var td = $(tr[i]).find("td");
                $(td[0]).html((index-1)*5+i);
                $(td[1]).html(data2[(index-1)*5+i-1]["c_name"]);
                $(td[2]).html(data2[(index-1)*5+i-1]["c_type"]);
                $(td[3]).html(data2[(index-1)*5+i-1]["c_connect"]);
                $(td[4]).html(data2[(index-1)*5+i-1]["c_address"]);
            }
        }

    }
    function down(){
        if(index*5<data2.length){
            index=index+1;
            clear();
            showin();
        }
    }
    function up(){
        if(index>1){
            index=index-1;
            clear();
            showin();
        }
    }
    function reshow(){
        index=1;
        showin();
    }
    function clear(){
        var tr = $("#table1 tr");
        for(var i=1;i<=5;i++){
            var td = $(tr[i]).find("td");
            $(td[0]).html("");
            $(td[1]).html("");
            $(td[2]).html("");
            $(td[3]).html("");
            $(td[4]).html("");
        }
    }
    function found(){
        var cname=document.getElementById("text1").value;
        var ctype=document.getElementById("text2").value;
        var caddress=document.getElementById("text3").value;
        var cdata={"u_email":em_email,"c_name":cname,"c_type":ctype,"c_address":caddress,"c_connect":""};
        var httpRequest = new XMLHttpRequest();//第一步：建立所需的对象
        httpRequest.open("POST", "http://localhost:8088/company/searchCompany",true);  //调用AddDataToServer
        httpRequest.setRequestHeader("Content-type", "application/JSON"); //设置请求头信
        httpRequest.send(JSON.stringify(cdata)); //设置为发送给服务器数据
        // 回调函数，获取返回数据
        httpRequest.onreadystatechange = function() {
            if (httpRequest.readyState == 4) {
                //根据服务器的响应内容格式处理响应结果
                if(httpRequest.getResponseHeader('content-type')==='application/json'){
                    var result = JSON.parse(httpRequest.responseText);
                    if(result[0]){
                        data2=result;
                        index=1;
                        clear();
                        showin();
                    }
                    else{
                        alert("没有相关数据");
                    }
                }
            }
        }
    }
    function reset() {
        document.getElementById("text1").value="";
        document.getElementById("text2").value="";
        document.getElementById("text3").value="";
    }

</script>
</html>